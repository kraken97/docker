version: '2'
services:
  nginx-proxy:
    build: nginx/
    ports:
      - "80:80"
    network_mode: "host"
  db-postgres:
    network_mode: "host"
    image: bitnami/postgresql:latest
    environment:
      - POSTGRESQL_PASSWORD=12345
      - POSTGRESQL_DATABASE=KS
    volumes:
      - /var/postgres_bitnami:/bitnami/postgresql
  db-mysql:
    image: mysql
    network_mode: "host"
    environment:
      - MYSQL_ROOT_PASSWORD=12345
  web:
    build: dotnet/.
    network_mode: "host"
    restart: on-failure
    volumes:
      - /var/upload:/var/upload/screenshots
  web-staging:
    build: dotnet-staging/.
    network_mode: "host"
    restart: on-failure
    volumes:
      - /var/upload:/var/upload/sceenshots
  web-test:
    build: dotnet_test/.
    network_mode: "host"
  registry:
    image: registry:2
    restart: always
    volumes:
      - /var/data:/var/lib/registry 
    ports:
      - "8888:5000"
